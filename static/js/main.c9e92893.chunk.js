(this["webpackJsonpnarrative-visualization"]=this["webpackJsonpnarrative-visualization"]||[]).push([[0],{154:function(e,t,a){},157:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),c=a(40),s=a.n(c),o=(a(154),a(4)),l=a.n(o),i=a(41),u=a(2),d=a(3),p=a(0),x=function(e){return Object(p.jsxs)("header",{className:"max-w-screen-2xl md:mb-12 w-full py-2 mx-auto mb-8 space-y-8 text-center",children:[Object(p.jsx)("h1",{className:"md:text-3xl lg:text-4xl text-xl",children:"2021 National Basketball Association Metrics"}),Object(p.jsx)("section",{className:"p-8 mx-auto space-y-4 border rounded shadow",children:"TODO: Cite data source TODO: key"})]})},b=function(e){return Object(p.jsx)("nav",{})},f={ATL:"Atlanta Hawks",BRK:"Brooklyn Nets",BOS:"Boston Celtics",CHO:"Charlotte Hornets",CHI:"Chicago Bulls",CLE:"Cleveland Cavaliers",DAL:"Dallas Mavericks",DEN:"Denver Nuggets",DET:"Detroit Pistons",GSW:"Golden State Warriors",HOU:"Houston Rockets",IND:"Indiana Pacers",LAC:"Los Angeles Clippers",LAL:"Los Angeles Lakers",MEM:"Memphis Grizzlies",MIA:"Miami Heat",MIL:"Milwaukee Bucks",MIN:"Minnesota Timberwolves",NOP:"New Orleans Pelicans",NYK:"New York Knicks",OKC:"Oklahoma City Thunder",ORL:"Orlando Magic",PHI:"Philadelphia 76ers",PHO:"Phoenix Suns",POR:"Portland Trail Blazers",SAC:"Sacramento Kings",SAS:"San Antonio Spurs",TOR:"Toronto Raptors",UTA:"Utah Jazz",WAS:"Washington Wizards"},m=Object.entries(f).map((function(e){var t=Object(u.a)(e,2);return{value:t[0],label:t[1]}})),j=[{value:"elo",label:"ELO"},{value:"raptor",label:"Raptor"},{value:"score",label:"Score"}],h=["January","February","March","April","May","June","July","August","September","October","November","December"],O=["2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08"],g=["p","q","s","c","f"],y={p:"Play-In",q:"Quarter Finals",s:"Semi Finals",c:"Conference Finals",f:"Finals"},v=function(e,t){switch(e){case"elo":return t.teamPreElo;case"raptor":return t.teamPreRaptor;case"score":return t.teamScore;default:return console.error("Unrecognized statistic category:",e),null}},w=function(e){var t=new Date(e),a=t.getFullYear(),r=h[t.getUTCMonth()];return"".concat(r," ").concat(a)},N=a(42),S=function(e){var t=e.pathData,a=e.selectedTeam,n=e.team,c=e.updateSelectedTeam,s=n===a,o=Object(r.useState)(!1),l=Object(u.a)(o,2),i=l[0],d=l[1],x=Object(r.useState)(),b=Object(u.a)(x,2),f=b[0],m=b[1],j=Object(r.useState)(),h=Object(u.a)(j,2),O=h[0],g=h[1];return Object(r.useEffect)((function(){if(s||i){var e=t.split("L"),a=e[e.length-1].split(","),r=Object(u.a)(a,2),n=r[0],c=r[1];m(Number(n)+12),g(Number(c)+6)}}),[i,s,t]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("path",{fill:"none",className:"\n                    stroke-current cursor-pointer\n                    transition-all ease-in-out\n                    ".concat(s?"text-gray-600":i?"text-purple-500":"text-gray-200","\n                ").trim(),d:t,strokeWidth:s||i?6:2,onClick:function(){return c(n)},onMouseOver:function(){return d(!0)},onMouseLeave:function(){return d(!1)}}),(s||i)&&f&&O&&Object(p.jsx)("text",{className:"\n                            text-base\n                            ".concat(s?"text-black":"text-purple-800","\n                        ").trim(),transform:"translate(".concat(f,", ").concat(O,")"),children:n})]})},M=function(e){var t=e.data,a=e.selectedTeam,r=e.dataLineFunc,n=e.updateSelectedTeam;return Object(p.jsx)("g",{className:"w-full h-full",id:"data-lines-wrapper",children:t&&t.map((function(e){var t=e.team,c=e.games;return c&&c.length&&Object(p.jsx)(S,{pathData:r(c),selectedTeam:a,team:t,updateSelectedTeam:n},"line-".concat(t))}))})},P=a(21),D=function(e){var t=e.chartHeight,a=e.chartWidth,n=e.x,c=e.y,s=e.gameData,o=Object(r.useRef)(),l=n+200<a?50:-50,i=c<t/2?Math.max(-100,40-c):Math.min(100,t-c-20),u=s||{},x=u.team,b=u.teamScore,f=u.opponent,m=u.opponentScore,j=u.wins,h=u.losses,O=b>m,g=[{x:n,y:c,dy:i,dx:l,note:{label:O?"".concat(x," improves to ").concat(j," - ").concat(h):"".concat(x," slides to ").concat(j," - ").concat(h),title:"".concat(O?"WIN against":"LOSS to"," ").concat(f," (").concat(b," - ").concat(m,")"),bgPadding:20},color:O?"#10B981":"#EF4444"}],y=Object(P.a)().editMode(!0).type(P.b).annotations(g);return Object(r.useEffect)((function(){o&&o.current&&d.h(o.current).call(y)}),[y,o]),Object(p.jsx)("g",{id:"annotations-wrapper",className:"annotation-group",ref:o})},T=function(e){var t=e.chartHeight,a=e.chartWidth,n=e.gameData,c=e.scaleX,s=e.scaleY,o=e.stat,l=c(new Date(n.date)),i=s(v(o,n)),d=Object(r.useState)(!1),x=Object(u.a)(d,2),b=x[0],f=x[1],m=n.teamScore>n.opponentScore;return Object(p.jsxs)("g",{onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)},children:[b&&Object(p.jsx)(D,{chartHeight:t,chartWidth:a,x:l,y:i,gameData:n}),Object(p.jsx)("circle",{className:"".concat(m?"text-green-500":"text-red-500"," cursor-pointer fill-current animate-pulse"),cx:l,cy:i,r:7}),Object(p.jsx)("circle",{className:"text-white cursor-pointer fill-current",cx:l,cy:i,r:5}),n.teamScore>n.opponentScore&&Object(p.jsx)("circle",{className:"".concat(m?"text-green-500":"text-red-500"," animate-pulse cursor-pointer fill-current"),cx:l,cy:i,r:3})]})},k=function(e){var t=e.chartHeight,a=e.chartWidth,r=e.data,n=e.scaleX,c=e.scaleY,s=e.stat;return Object(p.jsx)("g",{className:"w-full h-full",id:"data-points-wrapper",children:r&&r.map((function(e){return Object(p.jsx)(T,{chartHeight:t,chartWidth:a,gameData:e,scaleX:n,scaleY:c,stat:s},"game-data-".concat(e.date))}))})},E=800,C=64,_=function(e){var t=e.data,a=e.narrationMode,n=e.rawData,c=e.selectedTeam,s=e.showOnlyPlayoffs,o=e.stat,l=e.updateSelectedTeam,i=E,x=C,b=Object(r.useRef)(),f=Object(r.useState)({}),m=Object(u.a)(f,2),j=m[0],h=m[1],O=Object(r.useState)(),g=Object(u.a)(O,2),y=g[0],w=g[1],S=Object(r.useState)(),P=Object(u.a)(S,2),D=P[0],T=P[1],_=Object(r.useState)((function(){return function(){}})),R=Object(u.a)(_,2),A=R[0],L=R[1],H=Object(r.useState)((function(){return function(){}})),W=Object(u.a)(H,2),F=W[0],z=W[1],I=Object(r.useState)((function(){return function(){}})),B=Object(u.a)(I,2),Y=B[0],J=B[1],K=Object(r.useState)([]),U=Object(u.a)(K,2),X=U[0],G=U[1];return Object(r.useEffect)((function(){b&&b.current&&w(b.current.parentElement.clientWidth-x)}),[b,x]),Object(r.useEffect)((function(){var e=function(e){return e.reduce((function(e,t){var a=t.elo1_pre,r=t.elo2_pre,n=t.elo1_post,c=t.elo2_post,s=t.raptor1_pre,o=t.raptor2_pre,l=t.score1,i=t.score2;return{eloMin:Math.min(e.eloMin,a,r,n,c),eloMax:Math.max(e.eloMax,a,r,n,c),raptorMin:Math.min(e.raptorMin,s,o),raptorMax:Math.max(e.raptorMax,s,o),scoreMin:Math.min(e.scoreMin,l,i),scoreMax:Math.max(e.scoreMax,l,i)}}),{eloMin:99999,eloMax:0,raptorMin:99999,raptorMax:0,scoreMin:99999,scoreMax:0})}(n);h(e)}),[n]),Object(r.useEffect)((function(){var e=d.h(b.current).select("#chart-wrapper").attr("transform","translate(".concat(x,", 0)")),t=s?n.filter((function(e){return!!e.playoff})):n,a=d.d(t,(function(e){return new Date(e.date)})),r=a[1].setDate(a[1].getDate()+10),c=d.g().domain([a[0],r]).range([0,y-x]),l=d.a(c).ticks(d.i,"'%y %b %d").tickSize(-i+x);e.select("#x-axis").select("*").remove();var u=e.select("#x-axis").attr("transform","translate(0, ".concat(i-x,")")).call(l);u.select(".domain").attr("class",""),u.selectAll("line").attr("class","text-gray-200"),u.selectAll("text").attr("class","text-base text-gray-500 transform -rotate-90 text-right").attr("y",-6).attr("x",10-x);var p=d.f().domain(function(e,t){var a=function(e){return.98*Number(e)},r=function(e){return 1.02*Number(e)};switch(e){case"elo":return[a(t.eloMin),r(t.eloMax)];case"raptor":return[a(t.raptorMin),r(t.raptorMax)];case"score":return[a(t.scoreMin),r(t.scoreMax)];default:return console.error("No bounds found for stat:",e),[0,0]}}(o,j)).range([i-x,0]),f=d.b(p).ticks(5).tickPadding(20).tickSize(-y+x);e.select("#y-axis").select("*").remove();var m=e.select("#y-axis").call(f);m.select(".domain").remove(),m.selectAll("line").attr("class","text-gray-200"),m.selectAll("text").attr("class","text-base text-gray-800");var h=d.e().x((function(e){return c(new Date(e.date))})).y((function(e){return p(v(o,e))}));L((function(){return c})),z((function(){return p})),J((function(){return h}))}),[j,i,y,x,n,o,s]),Object(r.useEffect)((function(){if(a&&t){var e=Object.values(t).reduce((function(e,t){var a=t[t.length-1];return Number(a.teamPostElo)>Number(e.teamPostElo)?a:e}),{teamPostElo:0});e&&e.team&&l(e.team)}}),[a,t,l]),Object(r.useEffect)((function(){if(t){var e=Object.entries(t).reduce((function(e,t){var a=e.selectedTeamData,r=e.orderedData,n=Object(u.a)(t,2),s=n[0],o=n[1];return s===c?{selectedTeamData:{team:s,games:o},orderedData:r}:{selectedTeamData:a,orderedData:r.concat({team:s,games:o})}}),{selectedTeamData:null,orderedData:[]}),a=e.orderedData,r=e.selectedTeamData;G(r),T([].concat(Object(N.a)(a),[r]).filter((function(e){return e})))}}),[t,c,a]),Object(p.jsx)("svg",{className:"w-full transition-all ease-in-out",ref:b,width:y,height:i+x,children:Object(p.jsxs)("g",{id:"chart-wrapper",children:[Object(p.jsx)("g",{id:"x-axis",className:""}),Object(p.jsx)("g",{id:"y-axis",className:""}),D&&Object(p.jsxs)("g",{className:"w-full h-full",children:[Object(p.jsx)(M,{data:D,selectedTeam:c,dataLineFunc:Y,updateSelectedTeam:l}),X&&Object(p.jsx)(k,{chartHeight:i,chartWidth:y,data:X.games,scaleX:A,scaleY:F,stat:o})]})]})})},R=function(e){var t=e.maxDate,a=e.narrationMode,r=e.playoffRound,n=e.selectedStat,c=e.selectedTeam,s=e.showOnlyPlayoffs,o=e.updateMaxDate,l=e.updateNarrationMode,i=e.updatePlayoffRound,u=e.updateSelectedStat,d=e.updateSelectedTeam,x=e.updateShowOnlyPlayoffs;return Object(p.jsxs)("div",{className:"flex-nowrap flex items-end justify-start w-full px-16 space-x-12",children:[Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Visualization Mode"}),Object(p.jsxs)("button",{className:"nowrap flex overflow-hidden leading-tight text-gray-800 border rounded-full shadow",onClick:function(){return l(!a)},children:[Object(p.jsx)("span",{className:"block px-3 py-2 ".concat(a?"text-white bg-green-500":"bg-gray-100 text-gray-400"),children:"Narrative"}),Object(p.jsx)("span",{className:"block px-3 py-2 ".concat(a?"bg-gray-100 text-gray-400":"text-white bg-green-500"),children:"Exploratory"})]})]}),Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Show Only Playoffs"}),Object(p.jsx)("button",{className:"\n                        nowrap flex items-center w-16 p-1 overflow-hidden border rounded-full shadow-md\n                        ".concat(s?"bg-green-500":"bg-gray-100","\n                    "),onClick:function(){return x(!s)},children:Object(p.jsx)("div",{className:"block w-7 h-7 rounded-full border-2\n                        ".concat(s?"ml-auto border-white bg-white":"mr-auto bg-gray-50 border-gray-400","\n                    ")})})]}),Object(p.jsxs)("div",{className:"flex-nowrap flex space-x-4",children:[Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Statistic"}),Object(p.jsx)("select",{id:"statistic-select",className:"px-3 py-2 leading-tight text-gray-800 border rounded shadow",onChange:function(e){var t=e.target;return u(t.value)},value:n,children:j.map((function(e){return Object(p.jsx)("option",{value:e.value,children:e.label},e.value)}))})]}),Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Team"}),Object(p.jsxs)("select",{id:"team-select",className:"px-3 py-2 leading-tight text-gray-800 border rounded shadow",onChange:function(e){var t=e.target;return d(t.value)},value:c,children:[Object(p.jsx)("option",{value:"",children:"All"}),m.map((function(e){return Object(p.jsx)("option",{value:e.value,children:e.label},e.value)}))]})]})]}),!s&&Object(p.jsxs)("div",{className:"flex-nowrap flex items-end ml-8 space-x-2",children:[Object(p.jsx)("button",{className:"disabled:cursor-not-allowed disabled:text-gray-200 h-max-content px-3 py-2 leading-tight text-gray-800 border rounded shadow",disabled:O.indexOf(t)<=0,onClick:function(){var e=O.indexOf(t)-1;o(O[e])},children:"<"}),Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Max Date"}),Object(p.jsxs)("select",{id:"statistic-select",className:"px-3 py-2 leading-tight text-gray-800 border rounded shadow",onChange:function(e){var t=e.target;return o(t.value)},value:t,children:[Object(p.jsx)("option",{value:O[O.length-1],children:"All"},"all-option"),O.map((function(e){return Object(p.jsx)("option",{value:e,children:w(e)},e)}))]})]}),Object(p.jsx)("button",{className:"disabled:text-gray-200 disabled:cursor-not-allowed h-max-content px-3 py-2 leading-tight text-gray-800 border rounded shadow",disabled:!t||O.indexOf(t)>=O.length-1,onClick:function(){var e=O.indexOf(t)+1;o(O[e])},children:">"})]}),s&&Object(p.jsxs)("div",{className:"flex-nowrap flex items-end ml-8 space-x-2",children:[Object(p.jsx)("button",{className:"disabled:cursor-not-allowed disabled:text-gray-200 h-max-content px-3 py-2 leading-tight text-gray-800 border rounded shadow",disabled:g.indexOf(r)<1,onClick:function(){i(g[g.indexOf(r)-1])},children:"<"}),Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Playoff Round"}),Object(p.jsx)("select",{id:"statistic-select",className:"px-3 py-2 leading-tight text-gray-800 border rounded shadow",onChange:function(e){var t=e.target;return i(t.value)},value:r,children:g.map((function(e){return Object(p.jsx)("option",{value:e,children:y[e]},e)}))})]}),Object(p.jsx)("button",{className:"disabled:text-gray-200 disabled:cursor-not-allowed h-max-content px-3 py-2 leading-tight text-gray-800 border rounded shadow",disabled:g.indexOf(r)>=g.length-1,onClick:function(){i(g[g.indexOf(r)+1])},children:">"})]})]})},A=function(){return Object(p.jsx)("div",{className:"flex justify-center w-full py-3",children:Object(p.jsxs)("div",{className:"flex-nowrap flex space-x-4",children:[Object(p.jsxs)("div",{className:"flex items-center space-x-1",children:[Object(p.jsx)("div",{className:"flex items-center justify-center w-3.5 h-3.5 border-2 border-green-500 rounded-full animate-pulse",children:Object(p.jsx)("div",{className:"animate-pulse w-1.5 h-1.5 bg-green-500 rounded-full"})}),Object(p.jsx)("span",{children:"Win"})]}),Object(p.jsxs)("div",{className:"flex items-center space-x-1",children:[Object(p.jsx)("div",{className:"flex items-center justify-center w-3.5 h-3.5 border-2 border-red-500 rounded-full"}),Object(p.jsx)("span",{children:"Loss"})]})]})})},L=function(e){var t=e.data,a=Object(r.useState)(!0),n=Object(u.a)(a,2),c=n[0],s=n[1],o=Object(r.useState)("elo"),l=Object(u.a)(o,2),i=l[0],d=l[1],x=Object(r.useState)("MIL"),b=Object(u.a)(x,2),m=b[0],j=b[1],h=Object(r.useState)("2021-01"),O=Object(u.a)(h,2),y=O[0],v=O[1],w=Object(r.useState)(!1),N=Object(u.a)(w,2),S=N[0],M=N[1],P=Object(r.useState)(),D=Object(u.a)(P,2),T=D[0],k=D[1],E=Object(r.useState)(),C=Object(u.a)(E,2),L=C[0],H=C[1];return Object(r.useEffect)((function(){var e=Object.keys(f).reduce((function(e,a){var r=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"2021";return e.reduce((function(e,s){if(s.season!==c)return e;if(r&&(!s.playoff||g.indexOf(s.playoff)>g.indexOf(n)))return e;if(!r&&a&&a&&new Date(a)<new Date(s.date))return e;var o=e.length>0?e[e.length-1]:{wins:0,losses:0};if(s.team1===t){var l=Number(s.score1),i=Number(s.score2),u={date:s.date,playoff:s.playoff,team:s.team1,teamScore:l,teamPreElo:s.elo1_pre,teamPostElo:s.elo1_post,teamPreRaptor:s.raptor1_pre,teamRaptorProb:s.raptor_prob1,opponent:s.team2,opponentScore:i,opponentPreElo:s.elo2_pre,opponentPostElo:s.elo2_post,opponentPreRaptor:s.raptor2_pre,opponentRaptorProb:s.raptor_prob2,wins:l>i?o.wins+1:o.wins,losses:l<i?o.losses+1:o.losses};return e.concat(u)}if(s.team2===t){var d=Number(s.score2),p=Number(s.score1),x={date:s.date,playoff:s.playoff,team:s.team2,teamScore:d,teamPreElo:s.elo2_pre,teamPostElo:s.elo2_post,teamPreRaptor:s.raptor2_pre,teamRaptorProb:s.raptor_prob2,opponent:s.team1,opponentScore:p,opponentPreElo:s.elo1_pre,opponentPostElo:s.elo1_post,opponentPreRaptor:s.raptor1_pre,opponentRaptorProb:s.raptor_prob1,wins:d>p?o.wins+1:o.wins,losses:d<p?o.losses+1:o.losses};return e.concat(x)}return e}),[])}(t,a,y,S,T);return e[a]=r,e}),{});H(e)}),[t,y,S,T]),Object(p.jsxs)("div",{className:"max-w-screen-2xl flex flex-col items-center w-full p-8 mx-auto space-y-4 border rounded shadow",children:[Object(p.jsx)(R,{maxDate:y,narrationMode:c,playoffRound:T,selectedStat:i,selectedTeam:m,showOnlyPlayoffs:S,updateMaxDate:v,updateNarrationMode:s,updatePlayoffRound:k,updateSelectedStat:d,updateSelectedTeam:j,updateShowOnlyPlayoffs:function(e){M(e),k(e?"p":null)}}),Object(p.jsx)(A,{}),Object(p.jsx)(_,{data:L,narrationMode:c,rawData:t,showOnlyPlayoffs:S,stat:i,selectedTeam:m,updateSelectedTeam:function(e){return j(e)}})]})};var H=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(),s=Object(u.a)(c,2),o=s[0],f=s[1],m=function(){var e=Object(i.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.c)(t);case 2:a=e.sent,n(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){try{m("https://projects.fivethirtyeight.com/nba-model/nba_elo_latest.csv")}catch(e){console.error(e),f(e)}}),[]),Object(p.jsxs)("main",{className:"md:px-4 lg:px-8 w-full px-2 pb-8 mx-auto",children:[Object(p.jsx)(x,{}),Object(p.jsx)(b,{}),Object(p.jsxs)("section",{className:"",children:[o&&Object(p.jsx)("div",{children:"There was an error loading the data"}),!o&&a.length&&Object(p.jsx)(L,{data:a})]})]})},W=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,159)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),r(e),n(e),c(e),s(e)}))};s.a.render(Object(p.jsx)(n.a.StrictMode,{children:Object(p.jsx)(H,{})}),document.getElementById("root")),W()}},[[157,1,2]]]);
//# sourceMappingURL=main.c9e92893.chunk.js.map