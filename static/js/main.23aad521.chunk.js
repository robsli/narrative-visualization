(this["webpackJsonpnarrative-visualization"]=this["webpackJsonpnarrative-visualization"]||[]).push([[0],{151:function(e,t,a){},154:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),c=a(37),s=a.n(c),o=(a(151),a(4)),l=a.n(o),i=a(38),u=a(2),d=a(3),p=a(0),x=function(e){return Object(p.jsxs)("header",{className:"max-w-screen-2xl md:mb-12 w-full py-2 mx-auto mb-8 space-y-8 text-center",children:[Object(p.jsx)("h1",{className:"md:text-3xl lg:text-4xl text-xl",children:"2021 National Basketball Association Metrics"}),Object(p.jsx)("section",{className:"p-8 mx-auto space-y-4 border rounded shadow",children:"TODO: Cite data source TODO: key"})]})},b=function(e){return Object(p.jsx)("nav",{})},m={ATL:"Atlanta Hawks",BRK:"Brooklyn Nets",BOS:"Boston Celtics",CHO:"Charlotte Hornets",CHI:"Chicago Bulls",CLE:"Cleveland Cavaliers",DAL:"Dallas Mavericks",DEN:"Denver Nuggets",DET:"Detroit Pistons",GSW:"Golden State Warriors",HOU:"Houston Rockets",IND:"Indiana Pacers",LAC:"Los Angeles Clippers",LAL:"Los Angeles Lakers",MEM:"Memphis Grizzlies",MIA:"Miami Heat",MIL:"Milwaukee Bucks",MIN:"Minnesota Timberwolves",NOP:"New Orleans Pelicans",NYK:"New York Knicks",OKC:"Oklahoma City Thunder",ORL:"Orlando Magic",PHI:"Philadelphia 76ers",PHO:"Phoenix Suns",POR:"Portland Trail Blazers",SAC:"Sacramento Kings",SAS:"San Antonio Spurs",TOR:"Toronto Raptors",UTA:"Utah Jazz",WAS:"Washington Wizards"},j=Object.entries(m).map((function(e){var t=Object(u.a)(e,2);return{value:t[0],label:t[1]}})),f=[{value:"elo",label:"ELO"},{value:"raptor",label:"Raptor"},{value:"score",label:"Score"}],O=["January","February","March","April","May","June","July","August","September","October","November","December"],h=["2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08"],g=function(e,t){switch(e){case"elo":return t.teamPreElo;case"raptor":return t.teamPreRaptor;case"score":return t.teamScore;default:return console.error("Unrecognized statistic category:",e),null}},v=function(e){var t=new Date(e),a=t.getFullYear(),r=O[t.getUTCMonth()];return"".concat(r," ").concat(a)},w=function(e){var t=e.selectedStat,a=e.selectedTeam,r=e.maxDate,n=e.updateSelectedStat,c=e.updateSelectedTeam,s=e.updateMaxDate;return Object(p.jsxs)("div",{className:"flex-nowrap flex items-end mx-auto space-x-12",children:[Object(p.jsxs)("div",{className:"flex-nowrap flex space-x-4",children:[Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Statistic"}),Object(p.jsx)("select",{id:"statistic-select",className:"px-3 py-2 leading-tight text-gray-800 border rounded shadow",onChange:function(e){var t=e.target;return n(t.value)},value:t,children:f.map((function(e){return Object(p.jsx)("option",{value:e.value,children:e.label},e.value)}))})]}),Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Team"}),Object(p.jsxs)("select",{id:"team-select",className:"px-3 py-2 leading-tight text-gray-800 border rounded shadow",onChange:function(e){var t=e.target;return c(t.value)},value:a,children:[Object(p.jsx)("option",{value:"all",children:"All"}),j.map((function(e){return Object(p.jsx)("option",{value:e.value,children:e.label},e.value)}))]})]})]}),Object(p.jsxs)("div",{className:"flex-nowrap flex items-end ml-8 space-x-2",children:[Object(p.jsx)("button",{className:"disabled:cursor-not-allowed disabled:text-gray-200 h-max-content px-3 py-2 leading-tight text-gray-800 border rounded shadow",disabled:h.indexOf(r)<=0,onClick:function(){var e=h.indexOf(r)-1;s(h[e])},children:"<"}),Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Max Date"}),Object(p.jsxs)("select",{id:"statistic-select",className:"px-3 py-2 leading-tight text-gray-800 border rounded shadow",onChange:function(e){var t=e.target;return s(t.value)},value:r,children:[Object(p.jsx)("option",{value:h[h.length-1],children:"All"},"all-option"),h.map((function(e){return Object(p.jsx)("option",{value:e,children:v(e)},e)}))]})]}),Object(p.jsx)("button",{className:"disabled:text-gray-200 disabled:cursor-not-allowed h-max-content px-3 py-2 leading-tight text-gray-800 border rounded shadow",disabled:!r||h.indexOf(r)>=h.length-1,onClick:function(){var e=h.indexOf(r)+1;s(h[e])},children:">"})]}),Object(p.jsx)("div",{children:"TODO: add legend"})]})},S=a(39),y=function(e){var t=e.pathData,a=e.selectedTeam,n=e.team,c=e.updateSelectedTeam,s=n===a,o=Object(r.useState)(!1),l=Object(u.a)(o,2),i=l[0],d=l[1],x=Object(r.useState)(),b=Object(u.a)(x,2),m=b[0],j=b[1],f=Object(r.useState)(),O=Object(u.a)(f,2),h=O[0],g=O[1];return Object(r.useEffect)((function(){if(s||i){var e=t.split("L"),a=e[e.length-1].split(","),r=Object(u.a)(a,2),n=r[0],c=r[1];j(Number(n)+12),g(Number(c)+6)}}),[i,s,t]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("path",{fill:"none",className:"\n                    stroke-current cursor-pointer\n                    transition-all ease-in-out\n                    ".concat(s?"text-gray-600":i?"text-purple-500":"text-gray-200","\n                ").trim(),d:t,strokeWidth:s||i?6:2,onClick:function(){return c(n)},onMouseOver:function(){return d(!0)},onMouseLeave:function(){return d(!1)}}),(s||i)&&m&&h&&Object(p.jsx)("text",{className:"\n                            text-base\n                            ".concat(s?"text-black":"text-purple-800","\n                        ").trim(),transform:"translate(".concat(m,", ").concat(h,")"),children:n})]})},M=function(e){var t=e.data,a=e.selectedTeam,r=e.dataLineFunc,n=e.updateSelectedTeam;return Object(p.jsx)("g",{className:"w=full h-full",id:"data-lines-wrapper",children:t&&t.map((function(e){var t=e.team,c=e.games;return Object(p.jsx)(y,{pathData:r(c),selectedTeam:a,team:t,updateSelectedTeam:n},"line-".concat(t))}))})},N=function(e){var t=e.data,a=e.scaleX,r=e.scaleY,n=e.stat;return Object(p.jsx)("g",{className:"w-full h-full",id:"data-points-wrapper",children:t&&t.map((function(e){return Object(p.jsxs)("g",{children:[Object(p.jsx)("circle",{className:"text-blue-400 cursor-pointer fill-current",cx:a(new Date(e.date)),cy:r(g(n,e)),r:7}),Object(p.jsx)("circle",{className:"text-white cursor-pointer fill-current",cx:a(new Date(e.date)),cy:r(g(n,e)),r:5}),e.teamScore>e.opponentScore&&Object(p.jsx)("circle",{className:"animate-pulse text-blue-500 cursor-pointer fill-current",cx:a(new Date(e.date)),cy:r(g(n,e)),r:2})]},"game-data-".concat(e.date))}))})},D=800,T=64,P=function(e){var t=e.data,a=e.rawData,n=e.selectedTeam,c=e.stat,s=e.updateSelectedTeam,o=D,l=T,i=Object(r.useRef)(),x=Object(r.useState)({}),b=Object(u.a)(x,2),m=b[0],j=b[1],f=Object(r.useState)(),O=Object(u.a)(f,2),h=O[0],v=O[1],w=Object(r.useState)(),y=Object(u.a)(w,2),P=y[0],k=y[1],C=Object(r.useState)((function(){return function(){}})),_=Object(u.a)(C,2),E=_[0],A=_[1],L=Object(r.useState)((function(){return function(){}})),R=Object(u.a)(L,2),z=R[0],B=R[1],I=Object(r.useState)((function(){return function(){}})),F=Object(u.a)(I,2),H=F[0],W=F[1],J=Object(r.useState)([]),K=Object(u.a)(J,2),U=K[0],Y=K[1];return Object(r.useEffect)((function(){i&&i.current&&v(i.current.parentElement.clientWidth-l)}),[i,l]),Object(r.useEffect)((function(){var e=function(e){return e.reduce((function(e,t){var a=t.elo1_pre,r=t.elo2_pre,n=t.elo1_post,c=t.elo2_post,s=t.raptor1_pre,o=t.raptor2_pre,l=t.score1,i=t.score2;return{eloMin:Math.min(e.eloMin,a,r,n,c),eloMax:Math.max(e.eloMax,a,r,n,c),raptorMin:Math.min(e.raptorMin,s,o),raptorMax:Math.max(e.raptorMax,s,o),scoreMin:Math.min(e.scoreMin,l,i),scoreMax:Math.max(e.scoreMax,l,i)}}),{eloMin:99999,eloMax:0,raptorMin:99999,raptorMax:0,scoreMin:99999,scoreMax:0})}(a);j(e)}),[a]),Object(r.useEffect)((function(){var e=d.h(i.current).select("#chart-wrapper").attr("transform","translate(".concat(l,", ").concat(l,")")),t=d.d(a,(function(e){return new Date(e.date)})),r=t[1].setDate(t[1].getDate()+10),n=d.g().domain([t[0],r]).range([0,h-l]),s=d.a(n).ticks(d.i,"'%y %b %d").tickSize(-o+l);e.select("#x-axis").select("*").remove();var u=e.select("#x-axis").attr("transform","translate(0, ".concat(o-l,")")).call(s);u.select(".domain").attr("class",""),u.selectAll("line").attr("class","text-gray-200"),u.selectAll("text").attr("class","text-base text-gray-500 transform -rotate-90 text-right").attr("y",-6).attr("x",10-l);var p=d.f().domain(function(e,t){var a=function(e){return.98*Number(e)},r=function(e){return 1.02*Number(e)};switch(e){case"elo":return[a(t.eloMin),r(t.eloMax)];case"raptor":return[a(t.raptorMin),r(t.raptorMax)];case"score":return[a(t.scoreMin),r(t.scoreMax)];default:return console.error("No bounds found for stat:",e),[0,0]}}(c,m)).range([o-l,0]),x=d.b(p).ticks(5).tickPadding(20).tickSize(-h+l);e.select("#y-axis").select("*").remove();var b=e.select("#y-axis").call(x);b.select(".domain").remove(),b.selectAll("line").attr("class","text-gray-200"),b.selectAll("text").attr("class","text-base text-gray-800");var j=d.e().x((function(e){return n(new Date(e.date))})).y((function(e){return p(g(c,e))}));A((function(){return n})),B((function(){return p})),W((function(){return j}))}),[m,o,h,l,a,c]),Object(r.useEffect)((function(){if(t){var e=Object.entries(t).reduce((function(e,t){var a=e.selectedTeamData,r=e.orderedData,c=Object(u.a)(t,2),s=c[0],o=c[1];return s===n?{selectedTeamData:{team:s,games:o},orderedData:r}:{selectedTeamData:a,orderedData:r.concat({team:s,games:o})}}),{selectedTeamData:null,orderedData:[]}),a=e.orderedData,r=e.selectedTeamData;Y(r),k([].concat(Object(S.a)(a),[r]))}}),[t,n]),Object(p.jsx)("svg",{className:"w-full transition-all ease-in-out",ref:i,width:h,height:o+2*l,children:Object(p.jsxs)("g",{id:"chart-wrapper",children:[Object(p.jsx)("g",{id:"x-axis",className:""}),Object(p.jsx)("g",{id:"y-axis",className:""}),P&&Object(p.jsxs)("g",{className:"w-full h-full",children:[Object(p.jsx)(M,{data:P,selectedTeam:n,dataLineFunc:H,updateSelectedTeam:s}),Object(p.jsx)(N,{data:U.games,scaleX:E,scaleY:z,stat:c})]})]})})},k=function(e){var t=e.data,a=Object(r.useState)("elo"),n=Object(u.a)(a,2),c=n[0],s=n[1],o=Object(r.useState)("MIL"),l=Object(u.a)(o,2),i=l[0],d=l[1],x=Object(r.useState)("2021-01"),b=Object(u.a)(x,2),j=b[0],f=b[1],O=Object(r.useState)(),h=Object(u.a)(O,2),g=h[0],v=h[1];return Object(r.useEffect)((function(){var e=Object.keys(m).reduce((function(e,a){var r=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"2021";return e.reduce((function(e,n){if(n.season!==r)return e;if(a&&a&&new Date(a)<new Date(n.date))return e;var c=e[e.length-1]||{wins:0,loses:0};if(n.team1===t){var s={date:n.date,playoff:n.playoff,teamScore:n.score1,teamPreElo:n.elo1_pre,teamPostElo:n.elo1_post,teamPreRaptor:n.raptor1_pre,teamRaptorProb:n.raptor_prob1,opponent:n.team2,opponentScore:n.score2,opponentPreElo:n.elo2_pre,opponentPostElo:n.elo2_post,opponentPreRaptor:n.raptor2_pre,opponentRaptorProb:n.raptor_prob2,wins:n.score1>n.score2?c.wins+1:c.wins,loses:n.score1<n.score2?c.loses+1:c.loses};return e.concat(s)}if(n.team2===t){var o={date:n.date,playoff:n.playoff,teamScore:n.score2,teamPreElo:n.elo2_pre,teamPostElo:n.elo2_post,teamPreRaptor:n.raptor2_pre,teamRaptorProb:n.raptor_prob2,opponent:n.team1,opponentScore:n.score1,opponentPreElo:n.elo1_pre,opponentPostElo:n.elo1_post,opponentPreRaptor:n.raptor1_pre,opponentRaptorProb:n.raptor_prob1,wins:n.score2>n.score1?c.wins+1:c.wins,loses:n.score2<n.score1?c.loses+1:c.loses};return e.concat(o)}return e}),[])}(t,a,j);return e[a]=r,e}),{});v(e)}),[t,j]),Object(p.jsxs)("div",{className:"max-w-screen-2xl flex flex-col items-center w-full p-8 mx-auto space-y-4 border rounded shadow",children:[Object(p.jsx)(w,{selectedStat:c,selectedTeam:i,maxDate:j,updateSelectedStat:s,updateSelectedTeam:d,updateMaxDate:f}),Object(p.jsx)(P,{data:g,rawData:t,stat:c,selectedTeam:i,updateSelectedTeam:function(e){return d(e)}})]})};var C=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(),s=Object(u.a)(c,2),o=s[0],m=s[1],j=function(){var e=Object(i.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.c)(t);case 2:a=e.sent,n(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){try{j("https://projects.fivethirtyeight.com/nba-model/nba_elo_latest.csv")}catch(e){console.error(e),m(e)}}),[]),Object(p.jsxs)("main",{className:"md:px-4 lg:px-8 w-full px-2 mx-auto",children:[Object(p.jsx)(x,{}),Object(p.jsx)(b,{}),Object(p.jsxs)("section",{className:"",children:[o&&Object(p.jsx)("div",{children:"There was an error loading the data"}),!o&&a.length&&Object(p.jsx)(k,{data:a})]})]})},_=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,155)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),r(e),n(e),c(e),s(e)}))};s.a.render(Object(p.jsx)(n.a.StrictMode,{children:Object(p.jsx)(C,{})}),document.getElementById("root")),_()}},[[154,1,2]]]);
//# sourceMappingURL=main.23aad521.chunk.js.map