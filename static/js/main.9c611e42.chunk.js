(this["webpackJsonpnarrative-visualization"]=this["webpackJsonpnarrative-visualization"]||[]).push([[0],{152:function(e,t,a){},155:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),c=a(38),o=a.n(c),s=(a(152),a(4)),l=a.n(s),i=a(39),u=a(2),d=a(3),p=a(0),f=function(e){return Object(p.jsx)("header",{className:"w-full px-3 py-2",children:"Header"})},j=function(e){return Object(p.jsx)("nav",{})},b={ATL:"Atlanta Hawks",BRK:"Brooklyn Nets",BOS:"Boston Celtics",CHO:"Charlotte Hornets",CHI:"Chicago Bulls",CLE:"Cleveland Cavaliers",DAL:"Dallas Mavericks",DEN:"Denver Nuggets",DET:"Detroit Pistons",GSW:"Golden State Warriors",HOU:"Houston Rockets",IND:"Indiana Pacers",LAC:"Los Angeles Clippers",LAL:"Los Angeles Lakers",MEM:"Memphis Grizzlies",MIA:"Miami Heat",MIL:"Milwaukee Bucks",MIN:"Minnesota Timberwolves",NOP:"New Orleans Pelicans",NYK:"New York Knicks",OKC:"Oklahoma City Thunder",ORL:"Orlando Magic",PHI:"Philadelphia 76ers",PHO:"Phoenix Suns",POR:"Portland Trail Blazers",SAC:"Sacramento Kings",SAS:"San Antonio Spurs",TOR:"Toronto Raptors",UTA:"Utah Jazz",WAS:"Washington Wizards"},m=Object.entries(b).map((function(e){var t=Object(u.a)(e,2);return{value:t[0],label:t[1]}})),x=[{value:"elo",label:"ELO"},{value:"raptor",label:"Raptor"},{value:"score",label:"Score"}],O=function(e){var t=e.selectedStat,a=e.selectedTeam,r=e.updateSelectedStat,n=e.updateSelectedTeam;return Object(p.jsxs)("div",{className:"flex-nowrap flex space-x-4",children:[Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Team"}),Object(p.jsxs)("select",{id:"team-select",className:"px-3 py-2 leading-tight text-gray-800 border rounded shadow",onChange:function(e){var t=e.target;return n(t.value)},value:a,children:[Object(p.jsx)("option",{value:"all",children:"All"}),m.map((function(e){return Object(p.jsx)("option",{value:e.value,children:e.label},e.value)}))]})]}),Object(p.jsxs)("label",{className:"flex flex-col space-y-2",children:[Object(p.jsx)("span",{className:"text-sm font-medium text-gray-500 uppercase",children:"Statistic"}),Object(p.jsx)("select",{id:"statistic-select",className:"px-3 py-2 leading-tight text-gray-800 border rounded shadow",onChange:function(e){var t=e.target;return r(t.value)},value:t,children:x.map((function(e){return Object(p.jsx)("option",{value:e.value,children:e.label},e.value)}))})]})]})},h=function(e,t){switch(e){case"elo":return t.teamPreElo;case"raptor":return t.teamPreRaptor;case"score":return t.teamScore;default:return console.error("Unrecognized statistic category:",e),null}},v=a(40),g=function(e){var t=e.isSelected,a=e.pathData,n=e.selectedTeam,c=e.updateSelectedTeam,o=Object(r.useState)(!1),s=Object(u.a)(o,2),l=s[0],i=s[1];return Object(p.jsx)("path",{fill:"none",className:"\n                stroke-current cursor-pointer\n                ".concat(t?"text-gray-700":l?"text-blue-600":"text-gray-300","\n            "),d:a,strokeWidth:t?8:3,onClick:function(){return c(n)},onMouseOver:function(){return i(!0)},onMouseLeave:function(){return i(!1)}})},S=function(e){var t=e.data,a=e.scaleX,r=e.scaleY,n=e.stat;return Object(p.jsx)("g",{className:"w-full h-full",children:t&&t.map((function(e){return Object(p.jsx)("circle",{className:"text-red-200 cursor-pointer fill-current",cx:a(new Date(e.date)),cy:r(h(n,e)),r:4},"game-".concat(e.date))}))})},M=800,w=64,y=function(e){var t=e.data,a=e.rawData,n=e.selectedTeam,c=e.stat,o=e.updateSelectedTeam,s=M,l=w,i=Object(r.useRef)(),f=Object(r.useState)({}),j=Object(u.a)(f,2),b=j[0],m=j[1],x=Object(r.useState)(),O=Object(u.a)(x,2),y=O[0],P=O[1],N=Object(r.useState)(),T=Object(u.a)(N,2),D=T[0],_=T[1],E=Object(r.useState)((function(){return function(){}})),k=Object(u.a)(E,2),C=k[0],A=k[1],R=Object(r.useState)((function(){return function(){}})),L=Object(u.a)(R,2),z=L[0],H=L[1],I=Object(r.useState)((function(){return function(){}})),B=Object(u.a)(I,2),W=B[0],K=B[1],F=Object(r.useState)([]),U=Object(u.a)(F,2),Y=U[0],G=U[1];return Object(r.useEffect)((function(){i&&i.current&&P(i.current.parentElement.clientWidth-l)}),[i,l]),Object(r.useEffect)((function(){var e=function(e){return e.reduce((function(e,t){var a=t.elo1_pre,r=t.elo2_pre,n=t.elo1_post,c=t.elo2_post,o=t.raptor1_pre,s=t.raptor2_pre,l=t.score1,i=t.score2;return{eloMin:Math.min(e.eloMin,a,r,n,c),eloMax:Math.max(e.eloMax,a,r,n,c),raptorMin:Math.min(e.raptorMin,o,s),raptorMax:Math.max(e.raptorMax,o,s),scoreMin:Math.min(e.scoreMin,l,i),scoreMax:Math.max(e.scoreMax,l,i)}}),{eloMin:99999,eloMax:0,raptorMin:99999,raptorMax:0,scoreMin:99999,scoreMax:0})}(a);console.log("bounds:",e),m(e)}),[a]),Object(r.useEffect)((function(){var e=d.h(i.current).select("#chart-wrapper").attr("transform","translate(".concat(l,", ").concat(l,")")),t=d.g().domain(d.d(a,(function(e){return new Date(e.date)}))).range([0,y]),r=d.a(t).ticks(12).tickSize(-s);e.select("#x-axis").select("*").remove();var n=e.select("#x-axis").attr("transform","translate(0, ".concat(s,")")).call(r);n.select(".domain").attr("class",""),n.selectAll("line").attr("class","text-gray-200"),n.selectAll("text").attr("class","font-md text-blue-500");var o=d.f().domain(function(e,t){var a=function(e){return.95*Number(e)},r=function(e){return 1.05*Number(e)};switch(e){case"elo":return[a(t.eloMin),r(t.eloMax)];case"raptor":return[a(t.raptorMin),r(t.raptorMax)];case"score":return[a(t.scoreMin),r(t.scoreMax)];default:return console.error("No bounds found for stat:",e),[0,0]}}(c,b)).range([s,0]),u=d.b(o).ticks(5).tickSize(-y);e.select("#y-axis").select("*").remove();var p=e.select("#y-axis").call(u);p.select(".domain").remove(),p.selectAll("line").attr("class","text-gray-200"),p.selectAll("text").attr("class","font-md text-gray-800");var f=d.e().x((function(e){return t(new Date(e.date))})).y((function(e){return o(h(c,e))}));A((function(){return t})),H((function(){return o})),K((function(){return f}))}),[b,s,y,l,a,c]),Object(r.useEffect)((function(){if(t){var e=Object.entries(t).reduce((function(e,t){var a=e.selectedTeamData,r=e.orderedData,c=Object(u.a)(t,2),o=c[0],s=c[1];return o===n?{selectedTeamData:{team:o,games:s},orderedData:r}:{selectedTeamData:a,orderedData:r.concat({team:o,games:s})}}),{selectedTeamData:null,orderedData:[]}),a=e.orderedData,r=e.selectedTeamData;G(r),_([].concat(Object(v.a)(a),[r]))}}),[t,n]),Object(p.jsxs)("div",{className:"max-w-screen-2xl w-full p-6 border rounded shadow",children:[Object(p.jsx)("h2",{children:"Chart"}),Object(p.jsx)("svg",{className:"w-full",ref:i,width:y,height:s+2*l,children:Object(p.jsxs)("g",{id:"chart-wrapper",children:[Object(p.jsx)("g",{id:"x-axis"}),Object(p.jsx)("g",{id:"y-axis"}),Object(p.jsxs)("g",{className:"w-full h-full",children:[D&&D.map((function(e){var t=e.team,a=e.games;return Object(p.jsx)(g,{isSelected:t===n,pathData:W(a),selectedTeam:n,updateSelectedTeam:o},"line-".concat(t))})),D&&Object(p.jsx)(S,{data:Y.games,scaleX:C,scaleY:z,stat:c})]})]})})]})},P=function(e){var t=e.data,a=Object(r.useState)("elo"),n=Object(u.a)(a,2),c=n[0],o=n[1],s=Object(r.useState)("MIL"),l=Object(u.a)(s,2),i=l[0],d=l[1],f=Object(r.useState)(),j=Object(u.a)(f,2),m=j[0],x=j[1];return Object(r.useEffect)((function(){var e=Object.keys(b).reduce((function(e,a){var r=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"2021";return e.reduce((function(e,r){if(r.season!==a)return e;var n=e[e.length-1]||{wins:0,loses:0};if(r.team1===t){var c={date:r.date,playoff:r.playoff,teamScore:r.score1,teamPreElo:r.elo1_pre,teamPostElo:r.elo1_post,teamPreRaptor:r.raptor1_pre,teamRaptorProb:r.raptor_prob1,opponent:r.team2,opponentScore:r.score2,opponentPreElo:r.elo2_pre,opponentPostElo:r.elo2_post,opponentPreRaptor:r.raptor2_pre,opponentRaptorProb:r.raptor_prob2,wins:r.score1>r.score2?n.wins+1:n.wins,loses:r.score1<r.score2?n.loses+1:n.loses};return e.concat(c)}if(r.team2===t){var o={date:r.date,playoff:r.playoff,teamScore:r.score2,teamPreElo:r.elo2_pre,teamPostElo:r.elo2_post,teamPreRaptor:r.raptor2_pre,teamRaptorProb:r.raptor_prob2,opponent:r.team1,opponentScore:r.score1,opponentPreElo:r.elo1_pre,opponentPostElo:r.elo1_post,opponentPreRaptor:r.raptor1_pre,opponentRaptorProb:r.raptor_prob1,wins:r.score2>r.score1?n.wins+1:n.wins,loses:r.score2<r.score1?n.loses+1:n.loses};return e.concat(o)}return e}),[])}(t,a);return e[a]=r,e}),{});x(e)}),[t]),Object(p.jsxs)("div",{className:"flex flex-col items-center w-full px-8 space-y-8",children:[Object(p.jsx)(O,{selectedStat:c,selectedTeam:i,updateSelectedStat:o,updateSelectedTeam:d}),Object(p.jsx)(y,{data:m,rawData:t,stat:c,selectedTeam:i,updateSelectedTeam:d})]})};var N=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(),o=Object(u.a)(c,2),s=o[0],b=o[1],m=function(){var e=Object(i.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.c)(t);case 2:a=e.sent,console.log("latestEloData:",a),n(a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){try{m("https://projects.fivethirtyeight.com/nba-model/nba_elo_latest.csv")}catch(e){console.error(e),b(e)}}),[]),Object(p.jsxs)("main",{className:"w-full",children:[Object(p.jsx)(f,{}),Object(p.jsx)(j,{}),Object(p.jsxs)("section",{className:"",children:[s&&Object(p.jsx)("div",{children:"There was an error loading the data"}),!s&&a.length&&Object(p.jsx)(P,{data:a})]})]})},T=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,156)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,c=t.getLCP,o=t.getTTFB;a(e),r(e),n(e),c(e),o(e)}))};o.a.render(Object(p.jsx)(n.a.StrictMode,{children:Object(p.jsx)(N,{})}),document.getElementById("root")),T()}},[[155,1,2]]]);
//# sourceMappingURL=main.9c611e42.chunk.js.map